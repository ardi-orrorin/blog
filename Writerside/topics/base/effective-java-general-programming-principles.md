# 일반적인 프로그래밍 원칙

## 1. 지역 변수의 범위를 최소화하라.
- 지역 변수의 범위를 줄이는 가장 강력한 기법은 가장 처음 쓰일 때 선언하는 것이다.
- 거의 모든 지역변수는 선언과 동시에 초기화해야 한다.
- 초기화에 필요한 정보가 충분하지 앟다면 충분해질 때까지 선언을 미뤄야 한다. 단, Try-catch문은 예외다.
  - try 블록에서 선언된 변수는 try 블록 내에서만 사용되어야 한다.
- 메서드를 작게 유지하고 한 가지 기능에 집중하는 것이다.

## 2. 전통적인 for 문보다는 for-each 문을 사용하라.
- for-each 문은 명확하고, 유연하고, 버그를 줄여준다.
- 컬렉션과 배열을 순회할 때 전통적인 for 문을 사용하는 것은 코드를 지저분하게 만들고 버그를 일으킬 가능성을 높인다.
- for-each 문은 컬렉션과 배열뿐 아니라 Iterable 인터페이스를 구현하는 객체라면 무엇이든 순회할 수 있다.

## 3. 라이브러리를 익히고 사용하라.
- 표준 라이브러리를 사요하면 그 코드를 작성한 전무가의 지식과 앞서 사용한 다른 프로그래머의들의 경험을 활용할 수 있다.
- 자바 7부터는 ThreadLocalRandom으로 난수를 생성하는 것이 좋다. Random보다 빠르고 더 품질이 좋다.
  - 한편 포크-조인 풀이나 병렬 스틀미에서는 SplittableRnadom을 사용하는 것이 좋다.
- java.lang, java.util, java.io와 그 하위 패키지들에는 익숙해져야 한다.
  - java.util.concurrent 패키지는 멀티스레드 환경에서 사용할 수 있는 유용한 클래스들을 제공한다.

## 4. 정확한 답이 필요하다면 float와 double은 피하라.
- float와 double은 특히 금융 관련 계산과는 맞지 않는다. 음의 제겁수을 표현할 수 없기 때문
- bit 수가 부동소수점 연산에 사용되는데, 이는 0.1을 정확히 표현할 수 없다.
- 정확한 결과가 필요한 경우 BigDecimal, int, long을 사용하자.
- BigDecimal은 기본 타입보다 사용하기 불편하고, 느리다. 하지만 정확한 답이 필요한 상황에서는 유용하다.


## 5. 박싱된 기본 타입보다는 기본 타입을 사용하라.
- 박싱된 기본 타입에 == 연산자를 사용하면 제대로 된 결과를 얻을 수 없다.
- 기본 타입과 박싱된 기본 타입을 혼용한 연산에서는 언박싱된 타입으로 자동 형변환이 일어난다.
- 박싱된 타입의 사용처는 컬렉션의 원소, 키, 값으로 쓴다.
- 매개변수화 메서드의 타입 매개변수로 사용할 때만 박싱된 기본 타입을 사용하자.
- 제네릭 타입을 선언 할 때
- 리플렉션을 통해 메서드르 호출할 때
- 박싱된 기본 타입은 사용할 때는 번거로움을 줄여주지만, 그 위험까지는 없애주지 못 한다.
- 언박싱 과정에서 nullPointerException을 일으킬 수 있기 때문이다.

## 6. 다른 타입이 적절하다면 문자열 사용을 피하라.
- 문자열은 다른 값 타입을 대신하기에 적합하지 않다.
- 문자열은 열거 타입을 대신하기에 적합하지 않다.
- 문자열은 혼합 타입을 대신하기에 적합하지 않다.
- 문자열은 권한을 표현하기에 적합하지 않다.

```Java
// 혼합 타입을 문자열로 처리한 부적절한 예
String compoundKey = className + "#" + i.next();
```
## 7. 문자열 연결은 누리지 주의하라.
- 문자열 연결 연산자(+)로 문자열 n개를 잇는 시간은 n^2에 비례한다.
- 성능을 포기하고 싶지 않다면 String 대신 StringBuilder를 사용하자.

> 연산 성능 : StringBuilder > StringBuffer > String

> 멀티스레드 환경에서는 StringBuffer를 사용하자.

> StringBuilder는 단일 스레드 환경에서 사용하자.

> String은 짧은 문자열을 연결할 때만 사용하자.

## 8. 객체는 인터페이스를 사용해 참조하라.
- 적합한 인터페이스만 있담녀 매개변수뿐 아니라 반환값, 변수, 필드를 전부 인터페이스 타입으로 선언한다.
- 인터페이스를 타입으로 사용하는 습관을 길러두면 프로그램이 훨씬 유연해질 것이다.
- 적합한 인터페이슥 아벗다면 당연히 클래스로 참조해야 한다.
- 적합한 인터페이스가 없다면 클래스의 계층 구조 중 필요혀나 기능을 만족하는 가장 덜 구체적인(부모) 클래스 타입을 사용하자. 

```Java
// 좋은 예
Set<Son> sonSet = new LinkedHashSet<>();

// 나쁜 예
LinkedHashSet<Son> sonSet = new LinkedHashSet<>();}
```

## 9. 리플렉션보다는 인터페이스르 사용하라.
- 리플렉션은 컴파일 타입에 타입 검사가 주는 이점을 하나도 누릴수 없다.
- 리플렉션을 이용하면 코드가 지저분하고 장황해진다.
- 성능이 떨어진다.
- 리플렉션은 아주 제한된 형태로만 사용해야 그 단점을 피하고 이점만 취할 수 있다.
- 리플렉션은 인스턴스 생성에만 쓰고, 이렇게 만든 인스턴스는 인터페이스나 상위 클래스로 참조해 사용하자. 

## 10. 네이티브 메서드는 신중히 사용하라.
> 자바 네이티브 인터페이스(JNI)란 자바 프로그램이 네이티브 메서드를 호출하는 기능이다.
- 성능을 개선할 목적으로 네이티브 메서드를 사용하는 것은 거의 권장하지 않는다.
- 네이티브 언어가 안전하지 않으므로 애플리케이션도 메모리 훼손도 오류로부터 안전하지 않다.
- 네이티브 언어는 이식성이 낮다.
- 디버깅도 더 어렵다.
- 메모리는 자동 회수하지 못 하고, 추적도 불가능하다.
- 네이티브 메스드와 자바 코드 사이의 접착코드를 작성해야하는 수고로움이 있다.


## 11. 최적화는 신중히 하라.
- 성능 때문에 견고한 구조를 희생하지 말자.
- 빠른 프로그램보다는 좋은 프로그램을 작성하라
- 성능을 제한하는 설계를 피하라. 
- API를 설계할 때 성능에 주는 영향을 고려하라.
- 성능을 위해 API를 왜곡하는 건 매우 안 좋은 생각.
- 각각의 최적화 시도 전후로 성능을 측정하라




